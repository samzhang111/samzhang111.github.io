---
layout: post
title: xargs args
date: 2015-10-05 20:51:00
---

{{page.title}}
==============
{{page.date}}

Recently I've been trying to scrape [all of the websites of all of the
colleges on the Internet](/projects/2015-10-06-college-scraping.html). This has involved using
[xargs](http://man7.org/linux/man-pages/man1/xargs.1.html) to parallelize
wget. The command I used was:

```
 xargs -P16 wget < websites.txt
```

This (supposedly) tells xargs to spin up to 16 wget processes, and distribute
the inputs across them. However, there was a mistake. This
was a subtle mistake for me to catch, because (1) I have
inordinate amounts of faith in [strangers with blogs on the
Internet](http://www.boyter.org/2011/02/wget-xargs/), and (2) the command
explicitly said it would give me "up to" 16 processes, and since I was
running this on an ec2 micro instance, I thought, "maybe I just didn't
have enough memory?"

I find that the steps I take in accomplishing a task are often laden
with guesswork without even realizing it, especially when I'm working
by myself. I also find that I'm less likely to rigorously work out from
"first principles" (aka the documentation, or even my own knowledge)
when I'm spoon-fed some easy copypasta.  In retrospect, I could have
checked top, and when I discovered that wget was taking a fraction of
available memory and CPU, I could have become suspicious enough to check
the xargs manpage. Then, by reading carefully, I could have seen this
line:

```
Use the -n option with -P; otherwise chances are[*] that only one exec will be done.
```

I'm not very enthusiastic about that "chances
are" in the manpage. What does that mean? Looking at [one
version](http://www.opensource.apple.com/source/shell_cmds/shell_cmds-118/xargs/xargs.c)
of the xargs source code, you can see that the "-n" flag sets the "nargs"
variable is set to 5000 by default.

I don't see that default looking through the [GNU findutils version of
the code](http://mirrors.kernel.org/gnu/findutils/findutils-4.4.2.tar.gz)
though. Let me know if you figure it out?
